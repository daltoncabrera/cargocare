function Filter(e){return function(o,n){if(o)return o.indexOf("Z")===-1&&o.indexOf("+")===-1&&(o+="Z"),e("date")(o,n)}}angular.module("app").run(["$location","$rootScope","$window","toasty","$timeout","Upload",function(e,o,n,t,a,i){o.errorTriggered=!1,o.loadingMsg="",o.config={apiBase:location.origin+"/api"},o.title="",o.navName="",o.parentName="",o.parentTitle="",o.init=function(e){},o.timePickerOptions={step:15,minTime:"7:00am",maxTime:"5:00pm",timeFormat:"g:ia",appendTo:"body"},o.hasClaim=function(){for(var e=!1,n=0;n<arguments.length;n++)if(o.info.claims.indexOf(arguments[n])>=0){e=!0;break}return e},o.goTo=function(o){e.path(o)},o.goToRoot=function(e){var o=e;window.location=o},o.$on("$routeChangeSuccess",function(e,n,t){o.title=n.title,o.navName=n.navName,o.parentName=n.parentName,o.parentTitle=n.parentTitle}),o.uploadFile=function(e,n,t){e.upload=i.upload({url:n,data:{file:e}}),e.upload.then(function(o){a(function(){e.result=o.data,t&&t(o.data)})},function(e){if(e.status>0){var n=e.status+": "+e.data;o.error(":(",n)}},function(o){e.progress=Math.min(100,parseInt(100*o.loaded/o.total))})},o.success=function(e,o){t.success({title:e,msg:o,showClose:!0,clickToClose:!1,sound:!0,html:!1,shake:!1,onRemove:function(){}})},o.error=function(e,o){t.error({title:e,msg:o,showClose:!0,clickToClose:!1,sound:!0,html:!1,shake:!1,onRemove:function(){}})}}]),angular.module("app").config(["$httpProvider",function(e){e.interceptors.push("responseInterceptor")}]),angular.module("app").config(["toastyConfigProvider","calendarConfig",function(e,o){e.setConfig({sound:!0,position:"top-right",shake:!0,timeout:5e3}),o.dateFormatter="moment",o.allDateFormats.moment.date.time="hh:mma",o.i18nStrings.weekNumber="Week {week}",o.showTimesOnWeekView=!0}]),angular.module("app").config(["$routeProvider","$httpProvider","$locationProvider",function(e,o,n){o.defaults.headers.get||(o.defaults.headers.get={}),o.defaults.headers.get["If-Modified-Since"]="Mon, 26 Jul 1997 05:00:00 GMT",o.defaults.headers.get["Cache-Control"]="no-cache",o.defaults.headers.get.Pragma="no-cache",o.defaults.headers.get["X-Requested-With"]="XMLHttpRequest",e.when("/",{templateUrl:"dashboard/dashboard.html",controller:"DashboardCtrl",title:"Dashboard",navName:"dashboard",parentName:""}).when("/empresas",{templateUrl:"empresa/empresa.ctrl.html",controller:"empresaCtrl",parentTitle:"Configuracion",title:"Empresas",navName:"empresas",parentName:"configuracion"}).when("/empresa/:id",{templateUrl:"empresa/empresa.edit.ctrl.html",controller:"empresaEditCtrl",parentTitle:"Configuracion",title:"Empresas",navName:"empresa",parentName:"configuracion"}).when("/clientes",{templateUrl:"cliente/cliente.ctrl.html",controller:"clienteCtrl",parentTitle:"Configuracion",title:"Clientes",navName:"clientes",parentName:"configuracion"}).when("/cliente/:id",{templateUrl:"cliente/cliente.edit.ctrl.html",controller:"clienteEditCtrl",parentTitle:"Configuracion",title:"Creacion/Edicion Cliente",navName:"cliente",parentName:"configuracion"}).when("/terminales",{templateUrl:"terminal/terminal.ctrl.html",controller:"terminalCtrl",parentTitle:"Configuracion",title:"Terminales",navName:"terminal",parentName:"configuracion"}).when("/productos",{templateUrl:"producto/producto.ctrl.html",controller:"productoCtrl",parentTitle:"Configuracion",title:"Productos",navName:"producto",parentName:"configuracion"}).when("/sellos",{templateUrl:"sello/sello.ctrl.html",controller:"selloCtrl",parentTitle:"Clientes",title:"Sellos",navName:"sello",parentName:"sello"}).when("/camiones",{templateUrl:"camion/camion.ctrl.html",controller:"camionCtrl",parentTitle:"Clientes",title:"Camiones",navName:"camion",parentName:"camion"}).when("/cisternas",{templateUrl:"cisterna/cisterna.ctrl.html",controller:"cisternaCtrl",parentTitle:"Clientes",title:"Cisternas",navName:"cisterna",parentName:"cisterna"}).when("/choferes",{templateUrl:"chofer/chofer.ctrl.html",controller:"choferCtrl",parentTitle:"Clientes",title:"Choferes",navName:"chofer",parentName:"chofer"}).when("/precargas",{templateUrl:"precarga/precarga.ctrl.html",controller:"precargaCtrl",parentTitle:"Operaciones",title:"Precargas",navName:"precarga",parentName:"operaciones"}).when("/precarga/:id/:inspeccionId?",{templateUrl:"precarga/precarga.edit.ctrl.html",controller:"precargaEditCtrl",parentTitle:"Operaciones",title:"Creacion/Edicion precarga",navName:"editprecarga",parentName:"operaciones"}).when("/inspecciones",{templateUrl:"inspeccion/inspeccion.ctrl.html",controller:"inspeccionCtrl",parentTitle:"Operaciones",title:"Inspecciones",navName:"inspeccion",parentName:"inspeccion"}).when("/inspeccion/:id/:precargaId?",{templateUrl:"inspeccion/inspeccion.edit.ctrl.html",controller:"inspeccionEditCtrl",parentTitle:"Operaciones",title:"Creacion/Edicion Inspeccion",navName:"editinspeccion",parentName:"configuracion"}).when("/planificaciones",{templateUrl:"planificacion/planificacion.ctrl.html",controller:"planificacionCtrl",parentTitle:"Clientes",title:"Planificaciones",navName:"planificacion",parentName:"planificacion"}).when("/planificacion/:id",{templateUrl:"planificacion/planificacion.edit.ctrl.html",controller:"planificacionEditCtrl",parentTitle:"Clientes",title:"Creacion/Edicion Planificacion",navName:"editplanificacion",parentName:"configuracion"}).when("/usuarios",{templateUrl:"usuario/usuario.ctrl.html",controller:"usuarioCtrl",parentTitle:"Configuracion",title:"Usuarios",navName:"usuario",parentName:"configuracion"}).when("/usuario/:id",{templateUrl:"usuario/usuario.edit.ctrl.html",controller:"usuarioEditCtrl",parentTitle:"Configuracion",title:"Creacion/Edicion Usuario",navName:"editusuario",parentName:"configuracion"}).when("/actividades",{templateUrl:"reportes/actividades.ctrl.html",controller:"actividadesCtrl",parentTitle:"Reportes",title:"Reporte actvidades",navName:"actvidades",parentName:"reportes"}).when("/verificaciones",{templateUrl:"verificacion/verificacion.ctrl.html",controller:"verificacionCtrl",parentTitle:"Verficiacion",title:"Listado Verificacion",navName:"verificaciones",parentName:"Operaciones"}).when("/verificacion/:id",{templateUrl:"verificacion/verificacion.edit.ctrl.html",controller:"verificacionEditCtrl",parentTitle:"Verificacion",title:"Creacion/Edicion Verificacion",navName:"verificacionedit",parentName:"reportes"}).when("/reporteAct",{templateUrl:"reportes/reporteAct.ctrl.html",controller:"reporteActCtrl",parentTitle:"Reportes",title:"Reporte Actividades",navName:"reporteAct",parentName:"clientes"}).when("/reporteGeneral",{templateUrl:"reportes/reporteGeneral.ctrl.html",controller:"reporteGeneralCtrl",parentTitle:"Reportes",title:"Reporte General",navName:"reporteGeneral",parentName:"reportes"}).when("/401",{templateUrl:"error/noaccess.html",controller:"NoAccessCtrl",title:"401 - Access Denied"}).when("/404",{templateUrl:"error/notfound.html",controller:"NotFoundCtrl",title:"404 - Not Found"}).otherwise({redirectTo:"404"})}]),angular.module("app").controller("camionCtrl",["$scope","$rootScope","$http","Popeye","SweetAlert",function(e,o,n,t,a){e.camions=[],e.myPromise=!1,e.loadingMsg="Cargando...",e.refreshData=function(){e.myPromise=n.get(o.config.apiBase+"/camion",{"Content-Type":"application/json"}).then(function(o){e.camions=o.data},function(e){console.log(e)})},e.deletecamion=function(t){a.swal({title:"Esta seguro?",text:"Esta seguro de quere elimnar este camion!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!1,closeOnCancel:!0},function(i){i&&n["delete"](o.config.apiBase+"/camion/"+t,e.camion,{"Content-Type":"application/json"}).then(function(o){e.refreshData(),a.swal("Eliminado!","camion Eliminado.","success")})})},e.editcamion=function(o){var n=t.openModal({templateUrl:"camion/camion.edit.ctrl.html",controller:"camionEditCtrl",resolve:{camionId:function(){return o}}});e.showLoading=!0,n.resolved.then(function(){e.showLoading=!1}),n.closed.then(function(){e.refreshData()})},e.refreshData()}]),angular.module("app").controller("camionEditCtrl",["$scope","$rootScope","$http","camionId",function(e,o,n,t){e.myPromise=!1,e.loadingMsg="Cargando...",e.cisternas=[],e.choferes=[],e.camion={},e.camionId=t,e.getEmpresa=function(){e.myPromise=n.get(o.config.apiBase+"/camion/"+e.camionId,{"Content-Type":"application/json"}).then(function(o){e.camion=o.data.camion,e.cisternas=o.data.cisternas,e.choferes=o.data.choferes},function(e){console.log(e)})},e.titleMsg=e.camionId>0?"Editando camion":"Agregando camion",e.cancel=function(){e.$close()},e.saveData=function(t){console.log(t),t&&(e.camionId>0?e.myPromise=n.put(o.config.apiBase+"/camion/"+e.camionId,e.camion,{"Content-Type":"application/json"}).then(function(n){o.success("camion","camion guardado"),e.$close()},function(e){}):e.myPromise=n.post(o.config.apiBase+"/camion/",e.camion,{"Content-Type":"application/json"}).then(function(n){o.success("camions","camion guardado"),e.$close()},function(e){}))},e.getEmpresa()}]),angular.module("app").controller("cisternaCtrl",["$scope","$rootScope","$http","Popeye","SweetAlert",function(e,o,n,t,a){e.cisternas=[],e.myPromise=!1,e.loadingMsg="Cargando...",e.refreshData=function(){e.myPromise=n.get(o.config.apiBase+"/cisterna",{"Content-Type":"application/json"}).then(function(o){e.cisternas=o.data},function(e){console.log(e)})},e.deletecisterna=function(t){a.swal({title:"Esta seguro?",text:"Esta seguro de quere elimnar este cisterna!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!1,closeOnCancel:!0},function(i){i&&n["delete"](o.config.apiBase+"/cisterna/"+t,e.cisterna,{"Content-Type":"application/json"}).then(function(o){e.refreshData(),a.swal("Eliminado!","cisterna Eliminado.","success")})})},e.editcisterna=function(o){var n=t.openModal({templateUrl:"cisterna/cisterna.edit.ctrl.html",controller:"cisternaEditCtrl",resolve:{cisternaId:function(){return o}}});e.showLoading=!0,n.resolved.then(function(){e.showLoading=!1}),n.closed.then(function(){e.refreshData()})},e.refreshData()}]),angular.module("app").controller("cisternaEditCtrl",["$scope","$rootScope","$http","cisternaId",function(e,o,n,t){e.myPromise=!1,e.loadingMsg="Cargando...",e.model={cisterna:{compartimentos:0},detalle:[]},e.medidas=["1/8","2/8","3/8","4/8","5/8","6/8","7/8","1/16","3/16","5/16","7/16","9/16","10/16","11/16","9/16","13/16"],e.$watch("model.cisterna.compartimentos",function(o,n){e.changeCompartimentos(o,n)},!0),e.cisternaId=t,e.compartimentosArray=[{key:1,value:"Uno"},{key:2,value:"Dos"},{key:3,value:"Tres"},{key:4,value:"Cuatro"},{key:5,value:"Cinco"},{key:6,value:"Seis"}],e.getCisterna=function(){e.cisternaId>0&&(e.myPromise=n.get(o.config.apiBase+"/cisterna/"+e.cisternaId,{"Content-Type":"application/json"}).then(function(o){o.data.detalle=o.data.detalle.sort(function(e,o){return e.compartimento-o.compartimento}),e.model=o.data},function(e){console.log(e)}))},e.titleMsg=e.cisternaId>0?"Editando cisterna":"Agregando cisterna",e.cancel=function(){e.$close()},e.changeCompartimentos=function(o,n){if(e.cisternaForm.$dirty&&(e.model.detalle=[],o!=n)){for(var t=[],a=1;a<=o;a++){var i=3e3,c={compartimento:a,capacidad:i,hasChapa:!0,hasBoca:!0,hasDescarga:!0};t.push(c)}e.model.detalle=t.sort(function(e,o){return e.compartimento-o.compartimento})}},e.saveData=function(t){t&&(e.cisternaId>0?e.myPromise=n.put(o.config.apiBase+"/cisterna/"+e.cisternaId,e.model,{"Content-Type":"application/json"}).then(function(n){o.success("cisterna","cisterna guardado"),e.$close()},function(e){}):e.myPromise=n.post(o.config.apiBase+"/cisterna/",e.model,{"Content-Type":"application/json"}).then(function(n){o.success("cisternas","cisterna guardado"),e.$close()},function(e){}))},e.getCisterna()}]),angular.module("app").controller("choferCtrl",["$scope","$rootScope","$http","Popeye","SweetAlert",function(e,o,n,t,a){e.chofers=[],e.myPromise=!1,e.loadingMsg="Cargando...",e.refreshData=function(){e.myPromise=n.get(o.config.apiBase+"/chofer",{"Content-Type":"application/json"}).then(function(o){e.chofers=o.data},function(e){console.log(e)})},e.deletechofer=function(t){a.swal({title:"Esta seguro?",text:"Esta seguro de quere elimnar este chofer!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!1,closeOnCancel:!0},function(i){i&&n["delete"](o.config.apiBase+"/chofer/"+t,e.chofer,{"Content-Type":"application/json"}).then(function(o){e.refreshData(),a.swal("Eliminado!","chofer Eliminado.","success")})})},e.editchofer=function(o){var n=t.openModal({templateUrl:"chofer/chofer.edit.ctrl.html",controller:"choferEditCtrl",resolve:{choferId:function(){return o}}});e.showLoading=!0,n.resolved.then(function(){e.showLoading=!1}),n.closed.then(function(){e.refreshData()})},e.refreshData()}]),angular.module("app").controller("choferEditCtrl",["$scope","$rootScope","$http","choferId",function(e,o,n,t){e.myPromise=!1,e.loadingMsg="Cargando...",e.chofer={nombre:"",email:"",contacto:"",telefono:"",fax:"",logo:""},e.choferId=t,e.getEmpresa=function(){e.choferId>0&&(e.myPromise=n.get(o.config.apiBase+"/chofer/"+e.choferId,{"Content-Type":"application/json"}).then(function(o){e.chofer=o.data},function(e){console.log(e)}))},e.titleMsg=e.choferId>0?"Editando chofer":"Agregando chofer",e.cancel=function(){e.$close()},e.saveData=function(t){console.log(t),t&&(e.choferId>0?e.myPromise=n.put(o.config.apiBase+"/chofer/"+e.choferId,e.chofer,{"Content-Type":"application/json"}).then(function(n){o.success("chofer","chofer guardado"),e.$close()},function(e){}):e.myPromise=n.post(o.config.apiBase+"/chofer/",e.chofer,{"Content-Type":"application/json"}).then(function(n){o.success("chofers","chofer guardado"),e.$close()},function(e){}))},e.getEmpresa()}]),angular.module("app").controller("clienteCtrl",["$scope","$rootScope","$http","Popeye","SweetAlert",function(e,o,n,t,a){e.clientes=[],e.myPromise=!1,e.loadingMsg="Cargando...",e.refreshData=function(){e.myPromise=n.get(o.config.apiBase+"/Cliente",{"Content-Type":"application/json"}).then(function(o){e.clientes=o.data},function(e){console.log(e)})},e.deleteCliente=function(t){a.swal({title:"Esta seguro?",text:"Esta seguro de quere elimnar este cliente!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!1,closeOnCancel:!0},function(i){i&&n["delete"](o.config.apiBase+"/Cliente/"+t,e.cliente,{"Content-Type":"application/json"}).then(function(o){e.refreshData(),a.swal("Eliminado!","Cliente Eliminado.","success")})})},e.editCliente=function(o){var n=t.openModal({templateUrl:"cliente/cliente.edit.ctrl.html",controller:"clienteEditCtrl",resolve:{clienteId:function(){return o}}});e.showLoading=!0,n.resolved.then(function(){e.showLoading=!1}),n.closed.then(function(){e.refreshData()})},e.refreshData()}]),angular.module("app").controller("clienteEditCtrl",["$scope","$rootScope","$http","$routeParams","Upload",function(e,o,n,t,a){e.myPromise=!1,e.loadingMsg="Cargando...",e.cliente={id:0,nombre:"",email:"",contacto:"",telefono:"",fax:"",logo:""},e.clienteId=t.id,e.empresas=[],e.terminales=[],e.correos=[],e.productos=[],e.curCorreo=null,e.curTerminal=null,e.productoId=null,e.codigoProducto="",e.productosCliente=[],e.terminalPromise=!1,e.yesno=[{key:!0,value:"Yes"},{eky:!1,value:"No"}],e.conducesTpl=[],e.getCliente=function(){e.myPromise=n.get(o.config.apiBase+"/Cliente/"+e.clienteId,{"Content-Type":"application/json"}).then(function(o){o.data.cliente.inicioLabor&&(o.data.cliente.inicioLabor=moment.utc(o.data.cliente.inicioLabor).toDate()),o.data.cliente.finLabor&&(o.data.cliente.finLabor=moment.utc(o.data.cliente.finLabor).toDate()),e.cliente=o.data.cliente,e.empresas=o.data.empresas,e.productosCliente=o.data.productosCliente,e.productos=o.data.productos,e.correos=o.data.correos,e.cliente.empresaId=e.cliente.empresaId<=0?"":e.cliente.empresaId,e.conducesTpl=o.data.conducesTpl,e.getTerminales()},function(e){console.log(e)})},e.productoChanged=function(o){e.productoId=o},e.changeCodigo=function(o){e.codigoProducto=o},e.addProducto=function(){e.myPromise=n.post(o.config.apiBase+"/Cliente/AddToClient",{productoId:e.productoId,clienteId:e.cliente.id,codigoProducto:e.codigoProducto},{"Content-Type":"application/json"}).then(function(n){o.success("Clientes","Registro guardado"),e.productosCliente=n.data,e.productoId=null},function(e){})},e.removeProducto=function(t){e.myPromise=n.post(o.config.apiBase+"/Cliente/removeFromClient",{productoId:t,clienteId:e.cliente.id},{"Content-Type":"application/json"}).then(function(n){o.success("Clientes","Registro removido"),e.productosCliente=n.data},function(e){})},e.getTerminales=function(){e.terminalPromise=n.get(o.config.apiBase+"/Terminal/GetByCliente/"+e.clienteId,{"Content-Type":"application/json"}).then(function(o){e.terminales=o.data},function(e){console.log(e)})},e.curfile=!1,e.titleMsg=e.clienteId>0?"Editando Cliente":"Agregando Cliente",e.editMail=function(o){o||(o={clienteId:e.cliente.id,email:"",nombre:"",notificaPlanificacion:!1,notifcaOrden:!1,notificaInspeccion:!1}),e.curCorreo=o},e.editTerminal=function(o){o||(o={clienteId:e.cliente.id,esDestino:!0,destinoOrd:0,conduceCaption:""}),e.curTerminal=o},e.saveTerminal=function(){e.curTerminal.id>0?e.myPromise=n.put(o.config.apiBase+"/Terminal/"+e.curTerminal.id,e.curTerminal,{"Content-Type":"application/json"}).then(function(n){o.success("Clientes","Registro guardado"),e.curTerminal=null},function(e){}):e.myPromise=n.post(o.config.apiBase+"/Terminal",e.curTerminal,{"Content-Type":"application/json"}).then(function(n){o.success("Clientes","Registro guardado"),e.getTerminales(),e.curTerminal=null},function(e){})},e.cancelMail=function(){e.curCorreo=null},e.cancelTerminal=function(){e.curTerminal=null},e.removeTerminal=function(t){e.myPromise=n["delete"](o.config.apiBase+"/Terminal/"+t.id,{"Content-Type":"application/json"}).then(function(n){o.success("Clientes","Registro eliminado"),e.getTerminales()},function(e){})},e.saveMail=function(){e.myPromise=n.post(o.config.apiBase+"/Cliente/UpdateMail/",e.curCorreo,{"Content-Type":"application/json"}).then(function(n){o.success("Clientes","Correo guardado"),e.correos=n.data,e.curCorreo=null},function(e){})},e.deleteMail=function(t){e.myPromise=n.post(o.config.apiBase+"/Cliente/DeleteMail/",t,{"Content-Type":"application/json"}).then(function(n){o.success("Clientes","Correo eliminado"),e.correos=n.data},function(e){})},e.changeLogo=function(n,t){if(n){e.f=n,e.errFile=t&&t[0];var a="api/Cliente/Upload/?clienteId="+e.cliente.id;o.uploadFile(n,a,function(o){e.cliente.logo=o})}},e.saveData=function(t){console.log(t),t&&(e.clienteId>0?e.myPromise=n.put(o.config.apiBase+"/Cliente/"+e.clienteId,e.cliente,{"Content-Type":"application/json"}).then(function(n){o.success("Cliente","Cliente guardado"),e.$close()},function(e){}):e.myPromise=n.post(o.config.apiBase+"/Cliente/",e.cliente,{"Content-Type":"application/json"}).then(function(n){o.success("Clientes","Cliente guardado"),e.cliente=n.data},function(e){}))},e.getCliente()}]),angular.module("app").factory("responseInterceptor",["$q","$location","toasty","$rootScope",function(e,o,n,t){return{response:function(o){return 401===o.status&&console.log("Response 401"),o||e.when(o)},responseError:function(n){401===n.status&&(console.log("Response Error 401",n),o.path("/"));var a=n.statusText;return n.data&&(a=n.data),t.error("Error "+n.status+"!",a),e.reject(n)}}}]),angular.module("app").filter("utcToLocal",Filter),angular.module("storageService",[]).factory("StorageSvc",["$window",function(e){return{setLocal:function(o,n){try{return!!e.Storage&&(e.localStorage.setItem(o,e.JSON.stringify(n)),!0)}catch(t){console.error(t,t.message)}},getLocal:function(o){try{return!!e.Storage&&e.JSON.parse(e.localStorage.getItem(o))}catch(n){console.error(n,n.message)}},getLocalAll:function(){try{if(e.Storage){for(var o='{"Data": [',n=0;n<e.localStorage.length;n++)o+=e.localStorage.getItem(e.localStorage.key(n)),o+=",";return e.localStorage.length>0&&(o=o.substring(0,o.length-1)),o+="]}",e.JSON.parse(o)}return!1}catch(t){console.error(t,t.message)}},removeLocal:function(o){try{return!!e.Storage&&(e.localStorage.removeItem(o),!0)}catch(n){console.error(n,n.message)}},clearLocal:function(){try{if(!e.Storage)return!1;e.localStorage.clear()}catch(o){console.error(o,o.message)}},setSession:function(o,n){try{return!!e.Storage&&(e.sessionStorage.setItem(o,e.JSON.stringify(n)),!0)}catch(t){console.error(t,t.message)}},getSession:function(o){try{return!!e.Storage&&e.JSON.parse(e.sessionStorage.getItem(o))}catch(n){console.error(n,n.message)}},getSessionAll:function(){try{if(e.Storage){for(var o='{"Data": [',n=0;n<sessionStorage.length;n++)o+=e.JSON.parse(e.sessionStorage.getItem(n)),o+=",";return localStorage.length>0&&o.slice(0,-1),o+="]}"}return!1}catch(t){console.error(t,t.message)}},removeSession:function(o){try{return!!e.Storage&&(e.sessionStorage.removeItem(o),!0)}catch(n){console.error(n,n.message)}},clearSession:function(){try{if(!e.Storage)return!1;e.sessionStorage.clear()}catch(o){console.error(o,o.message)}}}}]),angular.module("app").filter("sumByKey",function(){return function(e,o){if("undefined"==typeof e||"undefined"==typeof o)return 0;for(var n=0,t=e.length-1;t>=0;t--)n+=parseInt(e[t][o]);return n}}),angular.module("app").controller("DashboardCtrl",["$scope","$rootScope","$http","Popeye","calendarConfig","$timeout","calendarTitle","$location",function(e,o,n,t,a,i,c,r){e.loadingMsg="cargando...",e.clientes=[],e.events=[],e.ordenes=[],e.terminales=[],e.productos=[],e.usuarios=[],e.camiones=[],e.choferes=[],e.cisternas=[],e.filterSello={},e.sellos=[],e.clientesPromise=!1,e.eventsPromise=!1,e.ordenesPromise=!1,e.terminalesPromise=!1,e.productosPromise=!1,e.usuariosPromise=!1,e.camionesPromise=!1,e.cisternasPromise=!1,e.choferesPromise=!1,e.sellosPromise=!1,e.calendarView="month",e.viewDate=moment().startOf("month").toDate(),e.excludedDays=[0,6],e.filter={clinicId:null},e.msg="",e.getTitle=function(){var o=moment(e.viewDate),n="";return"day"==e.calendarView&&(n=o.format("MMMM Do YYYY")),"month"==e.calendarView&&(n=o.format("MMMM YYYY")),"year"==e.calendarView&&(n=o.format("YYYY")),"week"==e.calendarView&&(n=o.format("[Week #]W [of] YYYY")),n},e.eventClicked=function(e){o.goToRoot("/App/"+e.empresaSlug+"/"+e.clienteSlug+"/#!/inspeccion/"+e.id)},e.clearFilter=function(){e.filter.clinicId=null,e.updateMsg(),e.loadEvents()},e.getClientes=function(){e.clientesPromise=n.get(o.config.apiBase+"/DashBoard/GetClientes",{"Content-Type":"application/json"}).then(function(o){e.clientes=o.data},function(e){console.log(e)})},e.getEvents=function(){e.eventsPromise=n.get(o.config.apiBase+"/DashBoard/GetPenddingOrders",{"Content-Type":"application/json"}).then(function(o){if(e.events=[],o.data)for(var n=0;n<o.data.length;n++){var t=o.data[n];e.events.push({id:t.ordenId,empresaNombre:t.empresaNombre,empresaSlug:t.empresaSlug,clienteNombre:t.clienteNombre,clienteSlug:t.clienteSlug,choferNombre:t.choferNombre,fichaCamion:t.fichaCamion,fichaCisterna:t.fichaCisterna,terminal:t.terminal,title:t.clienteNombre,color:a.colorTypes.info,startsAt:moment.utc(t.fecha).toDate()})}},function(e){console.log(e)})},e.getOrdenes=function(){e.ordenesPromise=n.get(o.config.apiBase+"/DashBoard/GetOrdenes",{"Content-Type":"application/json"}).then(function(o){e.ordenes=o.data},function(e){console.log(e)})},e.curId=0,e.print=function(o){e.curId=o,console.log(o);var n=t.openModal({templateUrl:"inspeccion/inspeccion.print.ctrl.html",containerClass:"popprint",controller:"inspeccionPrintCtrl",resolve:{url:function(){return"/Report/Inspeccion/"+e.curId}}});e.showLoading=!0,n.resolved.then(function(){e.showLoading=!1}),n.closed.then(function(){})},o.hasClaim("sadmin","supervisor","inspector")?(e.getClientes(),e.getOrdenes()):o.info.clienteId>0&&e.getOrdenes(),e.editinspeccion=function(e){r.path("/inspeccion/0/"+e)}}]);var dashboardService=angular.module("dashboardService",["ngResource"]);dashboardService.factory("DashSvc",["$resource","$rootScope",function(e,o){return e(":url/:action",{action:"@action"},{})}]),angular.module("app").controller("empresaCtrl",["$scope","$rootScope","$http","$location","Popeye","SweetAlert",function(e,o,n,t,a,i){e.empresas=[],e.myPromise=!1,e.loadingMsg="Cargando...",e.refreshData=function(){e.myPromise=n.get(o.config.apiBase+"/Empresa",{"Content-Type":"application/json"}).then(function(o){e.empresas=o.data},function(e){console.log(e)})},e.deleteEmpresa=function(t){i.swal({title:"Esta seguro?",text:"Esta seguro de quere elimnar esta empresa!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!1,closeOnCancel:!0},function(a){a&&n["delete"](o.config.apiBase+"/Empresa/"+t,e.empresa,{"Content-Type":"application/json"}).then(function(o){e.refreshData(),i.swal("Eliminado!","Empresa Eliminada.","success")})})},e.editEmpresa=function(e){t.path("empresa/"+e)},e.refreshData()}]),angular.module("app").controller("empresaEditCtrl",["$scope","$rootScope","$http","$location","$routeParams",function(e,o,n,t,a){e.myPromise=!1,e.loadingMsg="Cargando...",e.empresa={id:0},e.empresaId=a.id,e.settings={},e.getEmpresa=function(){e.empresaId>0&&(e.myPromise=n.get(o.config.apiBase+"/Empresa/"+e.empresaId,{"Content-Type":"application/json"}).then(function(o){e.empresa=o.data.empresa,o.data.settings&&(e.settings=o.data.settings)},function(e){console.log(e)}))},e.titleMsg=e.empresaId>0?"Editando Empresa":"Agregando Empresa",e.curfile=!1,e.changeLogo=function(n,t){if(n){e.f=n,e.errFile=t&&t[0];var a="api/Empresa/Upload/?empresaId="+e.empresa.id;o.uploadFile(n,a,function(o){e.empresa.logo=o})}},e.saveSettings=function(){e.settings.empresaId=e.empresa.id,e.myPromise=n.post(o.config.apiBase+"/Empresa/SaveSettings/",e.settings,{headers:{"Content-Type":"application/json"}}).then(function(n){o.success("Empresas","Registro guardado"),e.settings=n.data},function(e){})},e.sendTest=function(){e.settings.empresaId=e.empresa.id,e.myPromise=n.post(o.config.apiBase+"/Empresa/SendTest/"+e.empresa.id,null,{headers:{"Content-Type":"application/json"}}).then(function(e){o.success("Empresas","Correo de prueba enviado")},function(e){})},e.cancel=function(){e.$close()},e.saveData=function(t){t&&(e.empresaId>0?e.myPromise=n.put(o.config.apiBase+"/Empresa/"+e.empresaId,e.empresa,{headers:{"Content-Type":"application/json"}}).then(function(n){o.success("Empresas","Registro guardado"),e.empresa=n.data},function(e){}):e.myPromise=n.post(o.config.apiBase+"/Empresa/",e.empresa,{headers:{"Content-Type":"application/json"}}).then(function(n){o.success("Empresas","Registro guardado"),e.empresa=n.data},function(e){}))},e.getEmpresa()}]),angular.module("app").controller("NoAccessCtrl",["$scope",function(e){}]),angular.module("app").controller("NotFoundCtrl",["$scope",function(e){}]),function(){"use strict";function e(e){return function(o,n){if(o)return o.indexOf("Z")===-1&&o.indexOf("+")===-1&&(o+="Z"),e("date")(o,n)}}angular.module("app").filter("utcToLocal",e)}(),angular.module("app").controller("inspeccionCtrl",["$scope","$rootScope","$location","$http","Popeye","SweetAlert",function(e,o,n,t,a,i){e.inspecciones=[],e.ordenes=[],e.myPromise=!1,e.loadingMsg="Cargando...",e.togleDetail=function(e){e.showDetail=!e.showDetail},e.refreshData=function(){e.myPromise2=t.get(o.config.apiBase+"/inspeccion",{"Content-Type":"application/json"}).then(function(o){e.inspecciones=o.data},function(e){console.log(e)}),e.myPromise=t.get(o.config.apiBase+"/inspeccion/ordenes",{"Content-Type":"application/json"}).then(function(o){e.ordenes=o.data},function(e){console.log(e)})},e.deleteinspeccion=function(n){i.swal({title:"Esta seguro?",text:"Esta seguro de quere elimnar este inspeccion!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!1,closeOnCancel:!0},function(a){a&&t["delete"](o.config.apiBase+"/inspeccion/"+n,e.inspeccion,{"Content-Type":"application/json"}).then(function(o){e.refreshData(),i.swal("Eliminado!","inspeccion Eliminado.","success")})})},e.print=function(o){var n=a.openModal({templateUrl:"inspeccion/inspeccion.print.ctrl.html",containerClass:"popprint",controller:"inspeccionPrintCtrl",resolve:{url:function(){return"/Report/Inspeccion/"+o}}});e.showLoading=!0,n.resolved.then(function(){e.showLoading=!1}),n.closed.then(function(){e.refreshData()})},e.editinspeccion=function(e){n.path("/inspeccion/0/"+e)},e.refreshData()}]),angular.module("app").controller("inspeccionEditCtrl",["$scope","$rootScope","$http","$location","$routeParams","$filter","Popeye",function(e,o,n,t,a,i,c){e.myPromise=!1,e.loadingMsg="Cargando...",e.model={inspeccion:{},detalle:[]},e.fecha2=!1,e.fecha3=!1,e.inspeccionId=a.id,e.precargaId=a.precargaId,e.choferes=[],e.camiones=[],e.cisternas=[],e.productos=[],e.terminales=[],e.sellos=[],e.cisternaDetalles=[],e.choosedProducto=!1,e.curCisterna={},e.hstep=1,e.mstep=10,e.ismeridian=!1,e.$watch("model.inspeccion.camionId",function(o,n){e.camionChange(o,n)},!0),e.$watch("model.inspeccion.cisternaId",function(o,n){e.cisternaChange(o,n)},!0),e.camionChange=function(o,n){if(o!=n&&e.inspeccionForm.$dirty)for(var t=0;t<e.camiones.length;t++)if(e.camiones[t].key==o){e.model.inspeccion.cisternaId=e.camiones[t].cisternaId,e.model.inspeccion.choferId=e.camiones[t].choferId;break}},e.cisternaChange=function(o,n){if(o!=n&&e.inspeccionForm.$dirty){e.model.detalle=[];var t=[];e.choosedProducto=!1,console.log(e.cisternaDetalles);for(var a=0;a<e.cisternaDetalles.length;a++)if(console.log(o),console.log(e.cisternaDetalles[a].cisternaId),e.cisternaDetalles[a].cisternaId==o){var c=e.cisternaDetalles[a];t.push({compartimentoId:c.compartimento,cisternaDetalleId:c.id,capacidad:c.capacidad,selloChapaManholeId:null,selloChapaManhole:null,selloBocaCarga:null,selloBocaCargaId:null,selloBocaDescargaId:null,selloBocaDescarga:null,productoId:null,cantidad:c.capacidad,cantidadDespachada:c.capacidad,enUso:!0,hasChapa:c.hasChapa,hasBocaCarga:c.hasBoca,hasBocaDescarga:c.hasDescarga})}e.model.detalle=t.sort(function(e,o){return e.compartimento-o.compartimento}),e.model.detalle=i("orderBy")(e.model.detalle,"compartimento")}},e.selectSelloCallBack=function(t,a,i,c){if(0===c){i.selloChapaManholeId=t.id;1==i.compartimentoId&&n.get(o.config.apiBase+"/sello/GetSellosAfter",{params:{intSello:t.intSello}}).then(function(o){var n=o.data;if(n&&n.length>0)for(var t=0,a=0;a<e.model.detalle.length;a++)0==a?(e.model.detalle[a].enUso&&e.model.detalle[a].selloBocaCargaId<=0&&e.model.detalle[a].hasBocaCarga===!0&&(e.model.detalle[a].selloBocaCargaId=n[t].id,e.model.detalle[a].selloBocaCarga=n[t].codSello,t++),e.model.detalle[a].enUso&&e.model.detalle[a].selloBocaDescargaId<=0&&e.model.detalle[a].hasBocaDescarga===!0&&(e.model.detalle[a].selloBocaDescargaId=n[t].id,e.model.detalle[a].selloBocaDescarga=n[t].codSello,t++)):(e.model.detalle[a].enUso&&e.model.detalle[a].selloChapaManholeId<=0&&e.model.detalle[a].hasChapa===!0&&(e.model.detalle[a].selloChapaManholeId=n[t].id,e.model.detalle[a].selloChapaManhole=n[t].codSello,t++),e.model.detalle[a].enUso&&e.model.detalle[a].selloBocaCargaId<=0&&e.model.detalle[a].hasBocaCarga===!0&&(e.model.detalle[a].selloBocaCargaId=n[t].id,e.model.detalle[a].selloBocaCarga=n[t].codSello,t++),e.model.detalle[a].enUso&&e.model.detalle[a].selloBocaDescargaId<=0&&e.model.detalle[a].hasBocaDescarga===!0&&(e.model.detalle[a].selloBocaDescargaId=n[t].id,e.model.detalle[a].selloBocaDescarga=n[t].codSello,t++))})}else 1===c?i.selloBocaCargaId=t.id:2===c&&(i.selloBocaDesCargaId=t.id)},e.getSellos=function(t){return n.get(o.config.apiBase+"/sello/Search",{params:{filter:t,ordenId:e.ordenId}}).then(function(e){return e.data})},e.ngModelOptionsSelected=function(e){return arguments.length?void(_selected=e):_selected;
},e.ngModelOptionsSelected=function(e){return arguments.length?void(_selected=e):_selected},e.detalleChecked=function(e){e.enUso||(e.productoId=null,e.producto=null,e.cantidadConduce=null,e.selloChapaManholeId=null,e.selloChapaManhole=null,e.selloBocaCargaId=null,e.selloBocaCarga=null,e.selloBocaDesCargaId=null,e.selloBocaDescarga=null)},e.productoChanged=function(o){if(!e.choosedProducto){e.choosedProducto=!0;for(var n=0;n<e.model.detalle.length;n++)e.model.detalle[n].productoId=o}},e.getinspeccion=function(){e.myPromise=n.get(o.config.apiBase+"/inspeccion/"+e.inspeccionId+"/"+e.precargaId,{"Content-Type":"application/json"}).then(function(o){o.data.model.inspeccion&&o.data.model.inspeccion.fechaInicio&&(o.data.model.inspeccion.fechaInicio=moment(o.data.model.inspeccion.fechaInicio).toDate()),o.data.model.inspeccion&&o.data.model.inspeccion.fechaFin&&(o.data.model.inspeccion.fechaFin=moment(o.data.model.inspeccion.fechaFin).toDate()),e.model=o.data.model,e.choferes=o.data.choferes,e.camiones=o.data.camiones,e.cisternas=o.data.cisternas,e.cisternaDetalles=o.data.cisternaDetalles,e.productos=o.data.productos,e.sellos=o.data.sellos,e.sellos=o.data.sellos,e.terminales=o.data.terminales,e.destinos=o.data.destinos},function(e){console.log(e)})},e.titleMsg=e.inspeccionId>0?"Editando inspeccion":"Agregando inspeccion",e.cancel=function(){e.$close()},e.saveData=function(t){if(!t)return void o.error("Errores en el formulario, favor revisar datos");if(e.model.inspeccion.camionId<=0||e.model.inspeccion.choferId<=0||e.model.inspeccion.cisternaId<=0)return void o.error("Favor llenar camion, chofer y cisterna");if(e.model.inspeccion.llenaDetalle){for(var a=0;a<e.model.detalle.length;a++)if(e.model.detalle[a].enUso&&(e.model.detalle[a].productoId<=0||e.model.detalle[a].cantidadConduce<=0||e.model.detalle[a].cantidadMedida<=0))return void o.error("Favor indicar cantidad/cantidad medida y producto para los compartimentos en uso")}else if(e.model.inspeccion.cantidad<=0||e.model.inspeccion.productoId<=0)return void o.error("Favor indicar producto y cantidad");e.inspeccionId>0?e.myPromise=n.put(o.config.apiBase+"/inspeccion/"+e.inspeccionId,e.model,{"Content-Type":"application/json"}).then(function(e){o.success("inspeccion","inspeccion guardado")},function(e){}):e.myPromise=n.post(o.config.apiBase+"/inspeccion/",e.model,{"Content-Type":"application/json"}).then(function(n){o.success("inspeccions","inspeccion guardado"),o.goTo("/inspeccion/"+n.data.id),e.inspeccionId=n.data.id},function(e){})},e.print=function(){var o=c.openModal({templateUrl:"inspeccion/inspeccion.print.ctrl.html",containerClass:"popprint",controller:"inspeccionPrintCtrl",resolve:{url:function(){return"/Report/Inspeccion/"+e.inspeccionId}}});e.showLoading=!0,o.resolved.then(function(){e.showLoading=!1}),o.closed.then(function(){e.refreshData()})},e.getinspeccion()}]),angular.module("app").controller("inspeccionPrintCtrl",["$scope","$rootScope","$http","$sce","url",function(e,o,n,t,a){e.myPromise=!1,e.loadingMsg="Loading...",e.url=t.trustAsResourceUrl(a)}]),angular.module("app").controller("planificacionCtrl",["$scope","$rootScope","$http","$location","Popeye","SweetAlert",function(e,o,n,t,a,i){e.planificacions=[],e.myPromise=!1,e.loadingMsg="Cargando...",e.refreshData=function(){e.myPromise=n.get(o.config.apiBase+"/planificacion",{"Content-Type":"application/json"}).then(function(o){e.planificacions=o.data},function(e){console.log(e)})},e.deleteplanificacion=function(t){i.swal({title:"Esta seguro?",text:"Esta seguro de quere elimnar este planificacion!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!1,closeOnCancel:!0},function(a){a&&n["delete"](o.config.apiBase+"/planificacion/"+t,e.planificacion,{"Content-Type":"application/json"}).then(function(o){e.refreshData(),i.swal("Eliminado!","planificacion Eliminado.","success")})})},e.editplanificacion=function(e){e||(e=0),t.path("planificacion/"+e)},e.refreshData()}]),angular.module("app").controller("planificacionEditCtrl",["$scope","$rootScope","$http","$location","$routeParams","$sce","$interpolate","Popeye",function(e,o,n,t,a,i,c,r){e.myPromise=!1;t.search();e.loadingMsg="Cargando...",e.model={planificacion:{id:0},planificacionDespacho:[]},e.terminales=[],e.destinos=[],e.terminalId=0,e.planificacionId=a.id,e.removeTerminal=function(o){e.model.planificacionDespacho.splice(o,1)},e.sendMail=function(){e.myPromise=n.post(o.config.apiBase+"/Planificacion/SendMail/"+e.model.planificacion.id,null,{headers:{"Content-Type":"application/json"}}).then(function(n){o.success("Planificacion","Correo enviado"),e.settings=n.data},function(e){})},e.addTerminal=function(){var o={despacho:{terminalId:0,clienteId:e.model.planificacion.clienteId,planificacionId:e.model.planificacion.id},planificacionDetalle:[]};e.model.planificacionDespacho.push(o),e.timeWatcher()},e.timeWatcher=function(o,n){for(var t=e.daysBetweenDates(e.model.planificacion.fechaInicio,e.model.planificacion.fechaFin),a=0;a<e.model.planificacionDespacho.length;a++)for(var i=0;i<t.length;i++){e.model.planificacionDespacho[a].planificacionDetalle[i]={detalle:{fecha:t[i].fecha},destinos:[]};for(var c=0;c<e.destinos.length;c++)e.model.planificacionDespacho[a].planificacionDetalle[i].destinos.push({terminalId:e.destinos[c].key})}},e.getTable=function(o){for(var n="",t=0;t<e.model.planificacionDespacho.length;t++){n+='<table class="table1" style=""><thead><tr><th style="width:90px"></th><th class="thead" colspan="3">Despacho&nbsp;<a href="javascript:;" ng-click="removeTerminal('+t+')"  class="text-danger"><li class="fa fa-remove"></li></a></th> <th class="thead" colspan="{{destinos.length * 3 }}">Destino</th></tr>',n+='<tr><th></th><th colspan="3"><select style="width:100%" ng-change="" ng-options="item.key as item.value for item in terminales " id="terminal" name="terminal" ng-model="model.planificacionDespacho['+t+'].despacho.terminalId"><option value="">--select terminal--</option></select></th>',n+='<th colspan="3" style="text-align: center;border:1px solid #AAAAAA"  ng-repeat="dest in destinos track by $index">{{dest.value}}</th></tr>',n+="<tr><th></th><th>C. Qty</th><th>H. Inicio</th><th>H. Fin</th>";for(var a=0;a<e.destinos.length;a++)n+="<th>C. Qty</th><th>H. Inicio</th><th>H. Fin</th>";n+="</tr></thead><tbody>";for(var i=0;i<e.model.planificacionDespacho[t].planificacionDetalle.length;i++){var c=e.model.planificacionDespacho[t].planificacionDetalle[i].detalle.fecha.format("DD/MM/YYYY");n+="<tr>",n+="<td>"+c+"</td>",n+='<td><input type="number" ng-model="model.planificacionDespacho['+t+"].planificacionDetalle["+i+'].detalle.camionesQty"/></td>',n+=' <td><input ui-timepicker="$root.timePickerOptions" ng-model="model.planificacionDespacho['+t+"].planificacionDetalle["+i+'].detalle.fechaInicio"/></td>',n+='<td><input ui-timepicker="$root.timePickerOptions"  ng-model="model.planificacionDespacho['+t+"].planificacionDetalle["+i+'].detalle.fechaFin"/></td>';for(var r=0;r<e.destinos.length;r++){var o=e.getCurTerminal(e.destinos[r].key,e.model.planificacionDespacho[t].planificacionDetalle[i].destinos);n+='<td><input type="number" ng-model="model.planificacionDespacho['+t+"].planificacionDetalle["+i+"].destinos["+o+'].camionesQty"/></td>',n+='<td><input  ui-timepicker="$root.timePickerOptions" ng-model="model.planificacionDespacho['+t+"].planificacionDetalle["+i+"].destinos["+o+'].fechaInicio"/></td>',n+='<td><input  ui-timepicker="$root.timePickerOptions"  ng-model="model.planificacionDespacho['+t+"].planificacionDetalle["+i+"].destinos["+o+'].fechaFin"/></td>'}n+="</tr>"}n+="</tbody></table>"}return n},e.getCurTerminal=function(e,o){for(var n=0;n<o.length;n++)if(o[n].terminalId==e)return n},e.daysBetweenDates=function(e,o){e=moment(e),o=moment(o);for(var n=e,t=[];n.isBefore(o)||n.isSame(o);){n.format("dddd")+" "+n.format("DD")+" de "+n.format("MMMM");t.push({fecha:n.clone(),despachoDetalle:[]}),n.add(1,"days")}return t},e.getPlanificacion=function(){e.myPromise=n.get(o.config.apiBase+"/Planificacion/"+e.planificacionId,{"Content-Type":"application/json"}).then(function(o){o.data.model.planificacion.fechaInicio=moment.utc(o.data.model.planificacion.fechaInicio).toDate(),o.data.model.planificacion.fechaFin=moment.utc(o.data.model.planificacion.fechaFin).toDate();for(var n=0;n<o.data.model.planificacionDespacho.length;n++)for(var t=0;t<o.data.model.planificacionDespacho[n].planificacionDetalle.length;t++){o.data.model.planificacionDespacho[n].planificacionDetalle[t].detalle.fecha=moment.utc(o.data.model.planificacionDespacho[n].planificacionDetalle[t].detalle.fecha),o.data.model.planificacionDespacho[n].planificacionDetalle[t].detalle.fechaInicio=moment.utc(o.data.model.planificacionDespacho[n].planificacionDetalle[t].detalle.fechaInicio),o.data.model.planificacionDespacho[n].planificacionDetalle[t].detalle.fechaFin=moment.utc(o.data.model.planificacionDespacho[n].planificacionDetalle[t].detalle.fechaFin);for(var a=0;a<o.data.model.planificacionDespacho[n].planificacionDetalle[t].destinos.length;a++)o.data.model.planificacionDespacho[n].planificacionDetalle[t].destinos[a].fechaInicio=moment.utc(o.data.model.planificacionDespacho[n].planificacionDetalle[t].destinos[a].fechaInicio),o.data.model.planificacionDespacho[n].planificacionDetalle[t].destinos[a].fechaFin=moment.utc(o.data.model.planificacionDespacho[n].planificacionDetalle[t].destinos[a].fechaFin)}e.model=o.data.model,e.terminales=o.data.terminales,e.destinos=o.data.destinos,e.getprecargas()},function(e){console.log(e)})},e.titleMsg=e.planificacionId>0?"Editando planificacion":"Agregando planificacion",e.saveData=function(t){e.planificacionId>0?e.myPromise=n.put(o.config.apiBase+"/planificacion/"+e.planificacionId,JSON.stringify(e.model),{"Content-Type":"application/json"}).then(function(e){o.success("planificacion","planificacion guardado")},function(e){}):e.myPromise=n.post(o.config.apiBase+"/planificacion/",e.model,{"Content-Type":"application/json"}).then(function(e){o.success("planificacions","planificacion guardado")},function(e){})},e.getprecargas=function(){e.prePromise=n.get(o.config.apiBase+"/planificacion/GetPrecargas/"+e.planificacionId,{"Content-Type":"application/json"}).then(function(o){e.precargas=o.data},function(e){console.log(e)})},e.editPrecarga=function(o){var n=r.openModal({templateUrl:"precarga/precarga.edit.ctrl.html",modalClass:"modal-precarga",controller:"precargaEditCtrl",resolve:{$routeParams:function(){return{planificacionId:e.planificacionId,id:o}}}});e.showLoading=!0,n.resolved.then(function(){e.showLoading=!1}),n.closed.then(function(){e.getprecargas()})},e.getPlanificacion()}]),angular.module("app").controller("ordenCtrl",["$scope","$rootScope","$location","$http","Popeye","SweetAlert",function(e,o,n,t,a,i){e.ordenes=[],e.myPromise=!1,e.loadingMsg="Cargando...",e.refreshData=function(){e.myPromise=t.get(o.config.apiBase+"/orden",{"Content-Type":"application/json"}).then(function(o){e.ordenes=o.data},function(e){console.log(e)})},e.deleteorden=function(n){i.swal({title:"Esta seguro?",text:"Esta seguro de quere elimnar este orden!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!1,closeOnCancel:!0},function(a){a&&t["delete"](o.config.apiBase+"/orden/"+n,{"Content-Type":"application/json"}).then(function(o){e.refreshData(),i.swal("Eliminado!","orden Eliminado.","success")})})},e.editorden=function(e){n.path("/orden/"+e)},e.refreshData()}]),angular.module("app").controller("ordenEditCtrl",["$scope","$rootScope","$http","$location","$routeParams",function(e,o,n,t,a){e.myPromise=!1,e.loadingMsg="Cargando...",e.model={ordern:{},detalle:[]},e.fecha2=!1,e.ordenId=a.id,e.planificacionId=a.planificacionId,e.orden=[],e.detalle=[],e.choferes=[],e.camiones=[],e.cisternas=[],e.productos=[],e.terminales=[],e.sellos=[],e.cisternaDetalles=[],e.choosedProducto=!1,e.curCisterna={},e.hstep=1,e.mstep=10,e.ismeridian=!1,e.$watch("model.orden.camionId",function(o,n){e.camionChange(o,n)},!0),e.$watch("model.orden.cisternaId",function(o,n){e.cisternaChange(o,n)},!0),e.camionChange=function(o,n){if(o!=n&&e.ordenForm.$dirty)for(var t=0;t<e.camiones.length;t++)if(e.camiones[t].key==o){e.model.orden.cisternaId=e.camiones[t].cisternaId,e.model.orden.choferId=e.camiones[t].choferId;break}},e.cisternaChange=function(o,n){if(o!=n&&e.ordenForm.$dirty){e.model.detalle=[];var t=[];e.choosedProducto=!1;for(var a=0;a<e.cisternaDetalles.length;a++)if(e.cisternaDetalles[a].cisternaId==o){var i=e.cisternaDetalles[a];t.push({compartimento:i.compartimento,cisternaDetalleId:i.id,cantidadConduce:i.capacidad,selloChapaManholeId:0,selloChapaManhole:"",selloBocaCarga:"",selloBocaCargaId:0,selloBocaDescargaId:0,selloBocaDescarga:"",productoId:0,enUso:!0})}e.model.detalle=t.sort(function(e,o){return e.compartimento-o.compartimento})}},e.detalleChecked=function(e){e.enUso||(e.productoId=null,e.producto=null,e.cantidadConduce=null,e.selloChapaManholeId=null,e.selloChapaManhole=null,e.selloBocaCargaId=null,e.selloBocaCarga=null,e.selloBocaDesCargaId=null,e.selloBocaDescarga=null)},e.selectSelloCallBack=function(t,a,i,c){if(0===c){i.selloChapaManholeId=t.id;1==i.compartimento&&n.get(o.config.apiBase+"/sello/GetSellosAfter",{params:{intSello:t.intSello}}).then(function(o){var n=o.data;if(n&&n.length>0)for(var t=0,a=0;a<e.model.detalle.length;a++)console.log(e.model.detalle[a]),0==a?(e.model.detalle[a].selloBocaCargaId<=0&&(e.model.detalle[a].selloBocaCargaId=n[t].id,e.model.detalle[a].selloBocaCarga=n[t].codSello,t++),e.model.detalle[a].selloBocaDescargaId<=0&&(e.model.detalle[a].selloBocaDescargaId=n[t].id,e.model.detalle[a].selloBocaDescarga=n[t].codSello,t++)):(e.model.detalle[a].selloChapaManholeId<=0&&(e.model.detalle[a].selloChapaManholeId=n[t].id,e.model.detalle[a].selloChapaManhole=n[t].codSello,t++),e.model.detalle[a].selloBocaCargaId<=0&&(e.model.detalle[a].selloBocaCargaId=n[t].id,e.model.detalle[a].selloBocaCarga=n[t].codSello,t++),e.model.detalle[a].selloBocaDescargaId<=0&&(e.model.detalle[a].selloBocaDescargaId=n[t].id,e.model.detalle[a].selloBocaDescarga=n[t].codSello,t++))})}else 1===c?i.selloBocaCargaId=t.id:2===c&&(i.selloBocaDesCargaId=t.id)},e.getSellos=function(t){return n.get(o.config.apiBase+"/sello/Search",{params:{filter:t,ordenId:e.ordenId}}).then(function(e){return e.data})},e.ngModelOptionsSelected=function(e){return arguments.length?void(_selected=e):_selected},e.productoChanged=function(o){for(var n="",t=0;t<e.productos.length;t++)if(e.productos[t].key===o.productoId){n=e.productos[t].value;break}o.producto=n},e.getOrden=function(){e.myPromise=n.get(o.config.apiBase+"/orden/"+e.ordenId+"/"+e.planificacionId,{"Content-Type":"application/json"}).then(function(o){o.data.model.orden&&o.data.model.orden.fecha&&(o.data.model.orden.fecha=moment.utc(o.data.model.orden.fecha).toDate()),e.model=o.data.model,e.detalle=o.data.detalle,e.choferes=o.data.choferes,e.camiones=o.data.camiones,e.cisternas=o.data.cisternas,e.productos=o.data.productos,e.sellos=o.data.sellos,e.cisternaDetalles=o.data.cisternaDetalles,e.terminales=o.data.terminales},function(e){console.log(e)})},e.titleMsg=e.ordenId>0?"Editando orden":"Agregando orden",e.cancel=function(){e.$close()},e.saveData=function(t){if(t){if(e.model.orden.camionId<=0||e.model.orden.choferId<=0||e.model.orden.cisternaId<=0)return void o.error("Favor llenar camion, chofer y cisterna");for(var a=0;a<e.model.detalle.length;a++)if(e.model.detalle[a].enUso&&(e.model.detalle[a].productoId<=0||e.model.detalle[a].cantidad<=0))return void o.error("Favor indicar cantidad y producto para los compartimentos en uso");e.ordenId>0?e.myPromise=n.put(o.config.apiBase+"/orden/"+e.ordenId,e.model,{"Content-Type":"application/json"}).then(function(e){o.success("orden","orden guardado"),o.goTo("/ordenes")},function(e){}):e.myPromise=n.post(o.config.apiBase+"/orden/",e.model,{"Content-Type":"application/json"}).then(function(e){o.success("ordens","orden guardado"),o.goTo("/ordenes")},function(e){})}},e.getOrden()}]),angular.module("app").controller("precargaCtrl",["$scope","$rootScope","$location","$http","Popeye","SweetAlert",function(e,o,n,t,a,i){e.precargas=[],e.myPromise=!1,e.loadingMsg="Cargando...",e.refreshData=function(){e.myPromise=t.get(o.config.apiBase+"/precarga",{"Content-Type":"application/json"}).then(function(o){e.precargas=o.data},function(e){console.log(e)})},e.deleteprecarga=function(n){i.swal({title:"Esta seguro?",text:"Esta seguro de quere elimnar este precarga!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!1,closeOnCancel:!0},function(a){a&&t["delete"](o.config.apiBase+"/precarga/"+n,{"Content-Type":"application/json"}).then(function(o){e.refreshData(),i.swal("Eliminado!","precarga Eliminado.","success")})})},e.editprecarga=function(e){n.path("/precarga/"+e)},e.print=function(o){var n=a.openModal({templateUrl:"inspeccion/inspeccion.print.ctrl.html",containerClass:"popprint",controller:"inspeccionPrintCtrl",resolve:{url:function(){return"/Report/Precarga/"+o}}});e.showLoading=!0,n.resolved.then(function(){e.showLoading=!1}),n.closed.then(function(){})},e.refreshData()}]),angular.module("app").controller("precargaEditCtrl",["$scope","$rootScope","$http","$location","$routeParams","Popeye",function(e,o,n,t,a,i){e.myPromise=!1,e.loadingMsg="Cargando...",e.model={ordern:{},detalle:[]},e.fecha2=!1,e.precargaId=a.id,e.planificacionId=a.planificacionId,e.precarga={},e.detalle=[],e.choferes=[],e.camiones=[],e.cisternas=[],e.productos=[],e.terminales=[],e.destinos=[],e.sellos=[],e.cisternaDetalles=[],e.choosedProducto=!1,e.curCisterna={},e.hstep=1,e.mstep=10,e.ismeridian=!1,e.$watch("model.precarga.camionId",function(o,n){e.camionChange(o,n)},!0),e.$watch("model.precarga.cisternaId",function(o,n){e.cisternaChange(o,n)},!0),console.log(a),e.camionChange=function(o,n){if(o!=n&&e.precargaForm.$dirty)for(var t=0;t<e.camiones.length;t++)if(e.camiones[t].key==o){e.model.precarga.cisternaId=e.camiones[t].cisternaId,e.model.precarga.choferId=e.camiones[t].choferId;break}},e.cisternaChange=function(o,n){if(o!=n&&e.precargaForm.$dirty){e.choosedProducto=!1;for(var t=0;t<e.cisternaDetalles.length;t++)if(e.cisternaDetalles[t].cisternaId==o){e.cisternaDetalles[t]}}},e.cancel=function(){e.$close?e.$close():o.goTo("/precargas")},e.sumaCompartimentos=function(o,n){console.log(o);for(var t=0;t<e.model.detalle.length;t++){if(1==n&&e.model.detalle[t].compartimento1>0&&e.model.detalle[t].productoId!=o.productoId)return!0;if(2==n&&e.model.detalle[t].compartimento2>0&&e.model.detalle[t].productoId!=o.productoId)return!0;if(3==n&&e.model.detalle[t].compartimento3>0&&e.model.detalle[t].productoId!=o.productoId)return!0;if(4==n&&e.model.detalle[t].compartimento4>0&&e.model.detalle[t].productoId!=o.productoId)return!0;if(5==n&&e.model.detalle[t].compartimento5>0&&e.model.detalle[t].productoId!=o.productoId)return!0}return console.log("NA"),!1},e.print=function(){var o=i.openModal({templateUrl:"inspeccion/inspeccion.print.ctrl.html",containerClass:"popprint",controller:"inspeccionPrintCtrl",resolve:{url:function(){return"/Report/Precarga/"+e.precargaId}}});e.showLoading=!0,o.resolved.then(function(){e.showLoading=!1}),o.closed.then(function(){})},e.getprecarga=function(){e.myPromise=n.get(o.config.apiBase+"/precarga/"+e.precargaId+"/"+e.planificacionId,{"Content-Type":"application/json"}).then(function(o){o.data.model.precarga&&o.data.model.precarga.fecha&&(o.data.model.precarga.fecha=moment(o.data.model.precarga.fecha).toDate()),e.model=o.data.model,e.detalle=o.data.detalle,e.choferes=o.data.choferes,e.camiones=o.data.camiones,e.cisternas=o.data.cisternas,e.cisternaDetalles=o.data.cisternaDetalles,e.terminales=o.data.terminales,e.destinos=o.data.destinos},function(e){console.log(e)})},e.titleMsg=e.precargaId>0?"Editando precarga":"Agregando precarga",e.lineChanged=function(e){e.cantidad=e.compartimento1+e.compartimento2+e.compartimento3+e.compartimento4+e.compartimento5+e.compartimento6},e.saveData=function(t){if(t){if(e.model.precarga.camionId<=0||e.model.precarga.choferId<=0||e.model.precarga.cisternaId<=0)return void o.error("Favor llenar camion, chofer y cisterna");for(var a=0;a<e.model.detalle.length;a++);e.precargaId>0?e.myPromise=n.put(o.config.apiBase+"/precarga/"+e.precargaId,e.model,{"Content-Type":"application/json"}).then(function(e){o.success("precarga","precarga guardado")},function(e){}):e.myPromise=n.post(o.config.apiBase+"/precarga/",e.model,{"Content-Type":"application/json"}).then(function(n){o.success("precargas","precarga guardado"),e.model=n.data},function(e){})}},e.getprecarga()}]),angular.module("app").controller("actividadEditCtrl",["$scope","$rootScope","$http","actividadId",function(e,o,n,t){e.myPromise=!1,e.loadingMsg="Cargando...",e.actividad={nombre:"",telefono:"",direccion:"",multipleInstances:!1},e.actividadId=t,e.getactividad=function(){e.actividadId>0&&(e.myPromise=n.get(o.config.apiBase+"/actividad/"+e.actividadId,{"Content-Type":"application/json"}).then(function(o){e.actividad=o.data},function(e){console.log(e)}))},e.titleMsg=e.actividadId>0?"Editando actividad":"Agregando actividad",e.cancel=function(){e.$close()},e.saveData=function(t){console.log(t),t&&(e.actividadId>0?e.myPromise=n.put(o.config.apiBase+"/actividad/"+e.actividadId,e.actividad,{"Content-Type":"application/json"}).then(function(n){o.success("actividades","Registro guardado"),e.$close()},function(e){}):e.myPromise=n.post(o.config.apiBase+"/actividad/",e.actividad,{"Content-Type":"application/json"}).then(function(n){o.success("actividades","Registro guardado"),e.$close()},function(e){}))},e.getactividad()}]),angular.module("app").controller("actividadesCtrl",["$scope","$rootScope","$http","Popeye","SweetAlert","$uibModal",function(e,o,n,t,a,i){e.actividades=[],e.myPromise=!1,e.loadingMsg="Cargando...",e.model={},e.curIndex=null,e.isOpen=!1,e.altInputFormats=["M!/d!/yyyy"],e.getTitle=function(){if(e.model.dateFilter)return moment(e.model.dateFilter).format("dddd D, MMMM YYYY")},e.monthTitle=function(){if(e.model.dateFilterMonth)return moment(e.model.dateFilterMonth).format("MMMM YYYY")},e.yearTitle=function(){if(e.model.dateFilter)return moment(e.model.dateFilter).format("YYYY")},e.dateChanged=function(o,n){e.model.dir=n,e.refreshData()},e.monthChanged=function(o,n){e.model.dirMonth=n,e.refreshMonth()},e.dateOptions={maxDate:new Date},e.monthOptions={maxDate:new Date,minMode:"month"},e.yearOptions={maxDate:new Date,minMode:"year"},e.addNote=function(){var t=i.open({animation:!0,templateUrl:"observacion.html",controller:function(e){e.note=null,e.cancel=function(){e.$close(null)},e.ok=function(){e.$close(e.note)}},size:"md",resolve:{result:function(){return e.note}}});t.result.then(function(t){if(t&&""!=t){var i={nota:t,fecha:e.model.dateFilter,actividadId:e.actividades.actividadId,type:e.actividades.type};n.post(o.config.apiBase+"/actividad/AddObservation",i,{headers:{"Content-Type":"application/json"}}).then(function(o){e.refreshData(),a.swal("Guardado!","Observación/Comentario Guaradado","success")})}},function(){})},e.addNoteMonth=function(){var t=i.open({animation:!0,templateUrl:"observacion.html",controller:function(e){e.note=null,e.cancel=function(){e.$close(null)},e.ok=function(){e.$close(e.note)}},size:"md",resolve:{result:function(){return e.note}}});t.result.then(function(t){if(t&&""!=t){var i={nota:t,fecha:e.model.dateFilterMonth,actividadId:e.actividadesMonth.actividadId,type:e.actividadesMonth.type};n.post(o.config.apiBase+"/actividad/AddObservation",i,{headers:{"Content-Type":"application/json"}}).then(function(o){e.refreshMonth(),a.swal("Guardado!","Observación/Comentario Guaradado","success")})}},function(){})},e.refreshData=function(){e.myPromise=n.get(o.config.apiBase+"/actividad/GetDay/",{params:{dateInit:e.model.dateFilter,dir:e.model.dir}}).then(function(n){e.model.dir=null,e.actividades=n.data,e.actividades.dateFilterInit&&(e.model.dateFilter=moment.utc(e.actividades.dateFilterInit).toDate()),e.actividades.message&&o.success("Info",e.actividades.message)},function(e){console.log(e)})},e.refreshMonth=function(){e.myPromise=n.get(o.config.apiBase+"/actividad/GetMonth/",{params:{dateInit:e.model.dateFilterMonth,dir:e.model.dirMonth}}).then(function(n){e.model.dirMonth=null,e.actividadesMonth=n.data,e.actividadesMonth.dateFilterInit&&(e.model.dateFilterMonth=moment.utc(e.actividadesMonth.dateFilterInit).toDate()),e.actividadesMonth.message&&o.success("Info",e.actividades.message)},function(e){console.log(e)})},e.delNote=function(t){a.swal({title:"Esta seguro?",text:"Esta seguro de querer eliminar esta observación/comentario!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!1,closeOnCancel:!0},function(i){i&&n.post(o.config.apiBase+"/actividad/DeleteObservation",t,{headers:{"Content-Type":"application/json"}}).then(function(o){e.refreshMonth(),a.swal("Eliminado!","registro Eliminado.","success")})})},e.delNoteMonth=function(t){a.swal({title:"Esta seguro?",text:"Esta seguro de querer eliminar esta observación/comentario!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!1,closeOnCancel:!0},function(i){i&&n.post(o.config.apiBase+"/actividad/DeleteObservation",t,{headers:{"Content-Type":"application/json"}}).then(function(o){e.refreshData(),a.swal("Eliminado!","registro Eliminado.","success")})})},e.checkActividad=function(t){var i="Seguro que desea hacer visible este reporte",c="Mostrar",r="Registro ahora esta visible";t||(i="Seguro que desea ocultar este reporte",c="Ocultar",r="Registro ahora esta oculto"),a.swal({title:i,type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:c,cancelButtonText:"No, cancelar!",closeOnConfirm:!1,closeOnCancel:!0},function(i){i&&n.post(o.config.apiBase+"/actividad/checkActivity?flagVisible="+t,e.actividades,{headers:{"Content-Type":"application/json"}}).then(function(o){e.refreshData(),a.swal("Modificado!",r,"success")})})},e.checkActividadMonth=function(t){var i="Seguro que desea hacer visible este reporte",c="Mostrar",r="Registro ahora esta visible";t||(i="Seguro que desea ocultar este reporte",c="Ocultar",r="Registro ahora esta oculto"),a.swal({title:i,type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:c,cancelButtonText:"No, cancelar!",closeOnConfirm:!1,closeOnCancel:!0},function(i){i&&n.post(o.config.apiBase+"/actividad/checkActivity?flagVisible="+t,e.actividadesMonth,{headers:{"Content-Type":"application/json"}}).then(function(o){e.refreshMonth(),a.swal("Modificado!",r,"success")})})},e.resumen=function(){e.actividadesMonth||e.refreshMonth()},e.refreshData()}]),angular.module("app").controller("reporteActCtrl",["$scope","$rootScope","$http","$sce",function(e,o,n,t){e.reporteAct=[],e.myPromise=!1,e.loadingMsg="Cargando...",e.model={},e.curIndex=null,e.isOpen=!1,e.altInputFormats=["M!/d!/yyyy"],e.getTitle=function(){if(e.model.dateFilter)return moment(e.model.dateFilter).format("dddd D, MMMM YYYY")},e.monthTitle=function(){if(e.model.dateFilterMonth)return moment(e.model.dateFilterMonth).format("MMMM YYYY")},e.yearTitle=function(){if(e.model.dateFilter)return moment(e.model.dateFilter).format("YYYY")},e.dateChanged=function(a,i){e.myPromise=n.get(o.config.apiBase+"/actividad/getDateInfo/",{params:{dateInit:e.model.dateFilter,dir:i}}).then(function(n){console.log(n),e.model.dateFilter=moment.utc(n.data.dateFilterInit).toDate(),n.data.message&&o.success("Info",n.data.message),e.model.dir=i,e.url=t.getTrustedResourceUrl("report/ActividadesReport/?dateInit="+e.model.dateFilter.toLocaleDateString())},function(e){console.log(e)})},e.monthChanged=function(o,n){e.model.dirMonth=n,e.refreshMonth()},e.dateOptions={maxDate:new Date},e.monthOptions={maxDate:new Date,minMode:"month"},e.yearOptions={maxDate:new Date,minMode:"year"},e.refreshData=function(){e.dateChanged()},e.refreshMonth=function(){e.myPromise=n.get(o.config.apiBase+"/actividad/GetMonth/",{params:{dateInit:e.model.dateFilterMonth,dir:e.model.dirMonth}}).then(function(n){e.model.dirMonth=null,e.reporteActMonth=n.data,e.reporteActMonth.dateFilterInit&&(e.model.dateFilterMonth=moment.utc(e.reporteActMonth.dateFilterInit).toDate()),e.reporteActMonth.message&&o.success("Info",e.reporteAct.message)},function(e){console.log(e)})},e.resumen=function(){e.reporteActMonth||e.refreshMonth()},e.refreshData()}]),angular.module("app").controller("actividadEditCtrl",["$scope","$rootScope","$http","actividadId",function(e,o,n,t){e.myPromise=!1,e.loadingMsg="Cargando...",e.actividad={nombre:"",telefono:"",direccion:"",multipleInstances:!1},e.actividadId=t,e.getactividad=function(){e.actividadId>0&&(e.myPromise=n.get(o.config.apiBase+"/actividad/"+e.actividadId,{"Content-Type":"application/json"}).then(function(o){e.actividad=o.data},function(e){console.log(e)}))},e.titleMsg=e.actividadId>0?"Editando actividad":"Agregando actividad",e.cancel=function(){e.$close()},e.saveData=function(t){console.log(t),t&&(e.actividadId>0?e.myPromise=n.put(o.config.apiBase+"/actividad/"+e.actividadId,e.actividad,{"Content-Type":"application/json"}).then(function(n){o.success("reporteAct","Registro guardado"),e.$close()},function(e){}):e.myPromise=n.post(o.config.apiBase+"/actividad/",e.actividad,{"Content-Type":"application/json"}).then(function(n){o.success("reporteAct","Registro guardado"),e.$close()},function(e){}))},e.getactividad()}]),angular.module("app").controller("reporteGeneralCtrl",["$scope","$rootScope","$http","$sce",function(e,o,n,t){e.reporteGeneral=[],e.myPromise=!1,e.loadingMsg="Cargando...",e.model={},e.model.dateInit=new Date,e.model.dateEnd=new Date,e.model.reportName=null,e.model.grupo=null,e.model.periodo=null,e.model.destino=null,e.model.tipo=null,e.curIndex=null,e.isOpen=!1,e.altInputFormats=["M!/d!/yyyy"],e.periods=[{key:"dia",value:"Diario"},{key:"mes",value:"Mensual"},{key:"anio",value:"Anual"}],e.tipos=[{key:"listado",value:"Listado"},{key:"grafico",value:"Graficos"}],e.groups=[{key:"producto",value:"Producto"},{key:"destino",value:"Destino"},{key:"fecha",value:"fecha"}],e.reports=[{key:"GetProductsReport",value:"Movimiento de Productos"},{key:"GetCamionReport",value:"Reporte de Camiones"},{key:"GetChoferReport",value:"Reporte de Choferes"}],e.getTitle=function(){},e.isValid=function(){return e.model.dateInit&&e.model.dateEnd&&e.model.tipo&&e.model.periodo&&e.model.grupo},e.showReport=function(){e.url=t.getTrustedResourceUrl("AllReport/General/?name="+e.model.reportName+"&dateInit="+e.model.dateInit.toLocaleDateString()+"&dateEnd="+e.model.dateEnd.toLocaleDateString()+"&tipo="+e.model.tipo+"&periodo="+e.model.periodo+"&grupo="+e.model.grupo)},e.dateOptions={maxDate:new Date},e.monthOptions={maxDate:new Date,minMode:"month"},e.yearOptions={maxDate:new Date,minMode:"year"},e.refreshData=function(){e.showReport()}}]),angular.module("app").controller("productoCtrl",["$scope","$rootScope","$http","Popeye","SweetAlert",function(e,o,n,t,a){e.productoes=[],e.myPromise=!1,e.loadingMsg="Cargando...",e.refreshData=function(){e.myPromise=n.get(o.config.apiBase+"/producto",{"Content-Type":"application/json"}).then(function(o){e.productoes=o.data},function(e){console.log(e)})},e.deleteproducto=function(t){a.swal({title:"Esta seguro?",text:"Esta seguro de quere elimnar esta producto!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!1,closeOnCancel:!0},function(i){i&&n["delete"](o.config.apiBase+"/producto/"+t,e.producto,{"Content-Type":"application/json"}).then(function(o){e.refreshData(),a.swal("Eliminado!","producto Eliminada.","success")})})},e.editproducto=function(o){var n=t.openModal({
templateUrl:"producto/producto.edit.ctrl.html",controller:"productoEditCtrl",resolve:{productoId:function(){return o}}});e.showLoading=!0,n.resolved.then(function(){e.showLoading=!1}),n.closed.then(function(){e.refreshData()})},e.refreshData()}]),angular.module("app").controller("productoEditCtrl",["$scope","$rootScope","$http","productoId",function(e,o,n,t){e.myPromise=!1,e.loadingMsg="Cargando...",e.producto={nombre:"",telefono:"",direccion:"",multipleInstances:!1},e.productoId=t,e.getproducto=function(){e.productoId>0&&(e.myPromise=n.get(o.config.apiBase+"/producto/"+e.productoId,{"Content-Type":"application/json"}).then(function(o){e.producto=o.data},function(e){console.log(e)}))},e.titleMsg=e.productoId>0?"Editando producto":"Agregando producto",e.cancel=function(){e.$close()},e.saveData=function(t){console.log(t),t&&(e.productoId>0?e.myPromise=n.put(o.config.apiBase+"/producto/"+e.productoId,e.producto,{"Content-Type":"application/json"}).then(function(n){o.success("productoes","Registro guardado"),e.$close()},function(e){}):e.myPromise=n.post(o.config.apiBase+"/producto/",e.producto,{"Content-Type":"application/json"}).then(function(n){o.success("productoes","Registro guardado"),e.$close()},function(e){}))},e.getproducto()}]),angular.module("app").controller("rolCtrl",["$scope","$rootScope","$http","Popeye","SweetAlert",function(e,o,n,t,a){e.roles=[],e.myPromise=!1,e.loadingMsg="Cargando...",e.refreshData=function(){e.myPromise=n.get(o.config.apiBase+"/Permisos/Rol",{"Content-Type":"application/json"}).then(function(o){e.roles=o.data},function(e){console.log(e)})},e.deleteRol=function(t){a.swal({title:"Esta seguro?",text:"Esta seguro de quere elimnar este rol!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!1,closeOnCancel:!0},function(i){i&&n["delete"](o.config.apiBase+"/Permisos/Rol/"+t,e.rol,{"Content-Type":"application/json"}).then(function(o){e.refreshData(),a.swal("Eliminado!","Usuario Eliminada.","success")})})},e.editRol=function(o){var n=t.openModal({templateUrl:"app/rol/rol.edit.ctrl.html",controller:"rolEditCtrl",resolve:{rolId:function(){return o}}});e.showLoading=!0,n.resolved.then(function(){e.showLoading=!1}),n.closed.then(function(){e.refreshData()})},e.refreshData()}]),angular.module("app").controller("rolEditCtrl",["$scope","$rootScope","$http","rolId",function(e,o,n,t){e.myPromise=!1,e.loadingMsg="Cargando...",e.rol={name:"",description:""},e.rolId=t,e.getRol=function(){e.rolId>0&&(e.myPromise=n.get(o.config.apiBase+"/Permisos/Rol/"+e.rolId,{"Content-Type":"application/json"}).then(function(o){e.rol=o.data},function(e){console.log(e)}))},e.titleMsg=e.rolId>0?"Editando Rol":"Agregando Rol",e.cancel=function(){e.$close()},e.saveData=function(t){t&&(e.rolId>0?e.myPromise=n.put(o.config.apiBase+"/Permisos/Rol/"+e.rolId,e.rol,{"Content-Type":"application/json"}).then(function(n){o.success("Rols","Registro guardado"),e.$close()},function(e){}):e.myPromise=n.post(o.config.apiBase+"/Permisos/Rol/",e.rol,{"Content-Type":"application/json"}).then(function(n){o.success("Roles","Registro guardado"),e.$close()},function(e){}))},e.getRol()}]),angular.module("app").controller("terminalCtrl",["$scope","$rootScope","$http","Popeye","SweetAlert",function(e,o,n,t,a){e.terminales=[],e.myPromise=!1,e.loadingMsg="Cargando...",e.refreshData=function(){e.myPromise=n.get(o.config.apiBase+"/Terminal",{"Content-Type":"application/json"}).then(function(o){e.terminales=o.data},function(e){console.log(e)})},e.deleteTerminal=function(t){a.swal({title:"Esta seguro?",text:"Esta seguro de quere elimnar esta terminal!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!1,closeOnCancel:!0},function(i){i&&n["delete"](o.config.apiBase+"/Terminal/"+t,e.terminal,{"Content-Type":"application/json"}).then(function(o){e.refreshData(),a.swal("Eliminado!","Terminal Eliminada.","success")})})},e.editTerminal=function(o){var n=t.openModal({templateUrl:"terminal/terminal.edit.ctrl.html",controller:"terminalEditCtrl",resolve:{terminalId:function(){return o}}});e.showLoading=!0,n.resolved.then(function(){e.showLoading=!1}),n.closed.then(function(){e.refreshData()})},e.refreshData()}]),angular.module("app").controller("terminalEditCtrl",["$scope","$rootScope","$http","terminalId",function(e,o,n,t){e.myPromise=!1,e.loadingMsg="Cargando...",e.terminal={nombre:"",telefono:"",direccion:"",multipleInstances:!1},e.terminalId=t,e.getTerminal=function(){e.terminalId>0&&(e.myPromise=n.get(o.config.apiBase+"/Terminal/"+e.terminalId,{"Content-Type":"application/json"}).then(function(o){e.terminal=o.data},function(e){console.log(e)}))},e.titleMsg=e.terminalId>0?"Editando Terminal":"Agregando Terminal",e.cancel=function(){e.$close()},e.saveData=function(t){console.log(t),t&&(e.terminalId>0?e.myPromise=n.put(o.config.apiBase+"/Terminal/"+e.terminalId,e.terminal,{"Content-Type":"application/json"}).then(function(n){o.success("Terminales","Registro guardado"),e.$close()},function(e){}):e.myPromise=n.post(o.config.apiBase+"/Terminal/",e.terminal,{"Content-Type":"application/json"}).then(function(n){o.success("Terminales","Registro guardado"),e.$close()},function(e){}))},e.getTerminal()}]),angular.module("app").controller("verificacionCtrl",["$scope","$rootScope","$http","Popeye","SweetAlert",function(e,o,n,t,a){e.verificaciones=[],e.myPromise=!1,e.loadingMsg="Cargando...",e.refreshData=function(){e.myPromise=n.get(o.config.apiBase+"/verificacion",{headers:{"Content-Type":"application/json"}}).then(function(o){e.verificaciones=o.data},function(e){console.log(e)})},e.deleteverificacion=function(t){a.swal({title:"Esta seguro?",text:"Esta seguro de quere elimnar esta verificacion!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!1,closeOnCancel:!0},function(i){i&&n["delete"](o.config.apiBase+"/verificacion/"+t,e.verificacion,{headers:{"Content-Type":"application/json"}}).then(function(o){e.refreshData(),a.swal("Eliminado!","verificacion Eliminada.","success")})})},e.editVerificacion=function(e){o.goTo("/verificacion/"+e)},e.refreshData()}]),angular.module("app").controller("verificacionEditCtrl",["$scope","$rootScope","$http","$routeParams",function(e,o,n,t){e.myPromise=!1,e.loadingMsg="Cargando...",e.model={},e.choferes=[],e.camiones=[],e.cisternas=[],e.verificacionId=t.id,e.itemChange=function(e,o,n){n?(e.si=e.si&&1===o,e.no=e.no&&2===o):(e.bueno=e.bueno&&1===o,e.regular=e.regular&&2===o,e.malo=e.malo&&3===o)},e.getverificacion=function(){e.myPromise=n.get(o.config.apiBase+"/verificacion/"+e.verificacionId,{"Content-Type":"application/json"}).then(function(o){o.data.model.verificacion.fecha&&(o.data.model.verificacion.fecha=moment.utc(o.data.model.verificacion.fecha).toDate()),e.model=o.data.model,e.choferes=o.data.choferes,e.camiones=o.data.camiones,e.cisternas=o.data.cisternas},function(e){console.log(e)})},e.titleMsg=e.verificacionId>0?"Editando verificacion":"Agregando verificacion",e.cancel=function(){e.$close()},e.saveData=function(t){console.log(t),t&&(e.verificacionId>0?e.myPromise=n.put(o.config.apiBase+"/verificacion/"+e.verificacionId,e.model,{headers:{"Content-Type":"application/json"}}).then(function(n){o.success("verificaciones","Registro guardado"),e.$close()},function(e){}):e.myPromise=n.post(o.config.apiBase+"/verificacion/",e.model,{headers:{"Content-Type":"application/json"}}).then(function(n){o.success("verificaciones","Registro guardado"),e.$close()},function(e){}))},e.getverificacion()}]),angular.module("app").controller("usuarioCtrl",["$scope","$rootScope","$http","Popeye","SweetAlert",function(e,o,n,t,a){e.usuarios=[],e.myPromise=!1,e.loadingMsg="Cargando...",e.refreshData=function(){e.myPromise=n.get(o.config.apiBase+"/Permisos/Usuario",{"Content-Type":"application/json"}).then(function(o){e.usuarios=o.data},function(e){console.log(e)})},e.deleteUsuario=function(t){a.swal({title:"Esta seguro?",text:"Esta seguro de quere elimnar esta usuario!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!1,closeOnCancel:!0},function(i){i&&n["delete"](o.config.apiBase+"/Permisos/Usuario/"+t,e.usuario,{"Content-Type":"application/json"}).then(function(o){e.refreshData(),a.swal("Eliminado!","Usuario Eliminada.","success")})})},e.editUsuario=function(o){var n=t.openModal({templateUrl:"usuario/usuario.edit.ctrl.html",controller:"usuarioEditCtrl",resolve:{usuarioId:function(){return o}}});e.showLoading=!0,n.resolved.then(function(){e.showLoading=!1}),n.closed.then(function(){e.refreshData()})},e.refreshData()}]),angular.module("app").controller("usuarioEditCtrl",["$scope","$rootScope","$routeParams","$location","$http",function(e,o,n,t,a){e.myPromise=!1,e.loadingMsg="Cargando...",e.usuarioId=n.id,e.getUsuario=function(){e.myPromise=a.get(o.config.apiBase+"/Permisos/Usuario/"+e.usuarioId,{"Content-Type":"application/json"}).then(function(o){e.usuario=o.data,e.usuarioId||(e.usuario.activo=!0)},function(e){console.log(e)})},e.titleMsg=e.usuarioId>0?"Editando Usuario":"Agregando Usuario",e.cancel=function(){e.$close()},e.resetPassword=function(){e.usuarioId>0&&(e.myPromise=a.post("/Account/ResetUserPassword/",e.usuario,{"Content-Type":"application/json"}).then(function(e){o.success("Usuario","Datos guardados"),alert("Temporal Pass: "+e.data.tempPassword)},function(e){}))},e.saveData=function(n){n&&(e.usuarioId>0?e.myPromise=a.put(o.config.apiBase+"/Permisos/Usuario/"+e.usuarioId,e.usuario,{"Content-Type":"application/json"}).then(function(n){o.success("Usuarios","Registro guardado"),e.$close()},function(e){}):e.myPromise=a.post(o.config.apiBase+"/Permisos/Usuario/",e.usuario,{"Content-Type":"application/json"}).then(function(e){o.success("Usuarios","Registro guardado"),alert("Temporal Pass: "+e.data.password),o.goTo("/usuario/"+e.data.user.id)},function(e){}))},e.getUsuario()}]),angular.module("app").controller("selloCtrl",["$scope","$rootScope","$http","Popeye","SweetAlert",function(e,o,n,t,a){e.sellos=[],e.filter={},e.search="",e.myPromise=!1,e.lotes=[],e.estatus=[],e.curEstatus="",e.curPage=0,e.loadingMsg="Cargando...",e.curDetalleId=0,e.update=function(t){e.myPromise=n.put(o.config.apiBase+"/sello/"+t.id,t,{"Content-Type":"application/json"}).then(function(n){console.log(n),o.success("sello","sello guardado");for(var t=0;t<e.sellos.length;t++)if(e.sellos[t].id===n.data.id){e.sellos[t].selloStatus=n.data.selloStatus,e.sellos[t].selloStatusId=n.data.selloStatusId;break}e.curDetalleId=0},function(e){})},e.cancel=function(){e.curDetalleId=0},e.editsello=function(o){e.curDetalleId=o.id>0?o.id:0},e.addsello=function(){var o=t.openModal({templateUrl:"sello/sello.edit.ctrl.html",controller:"selloEditCtrl",resolve:{selloId:function(){return 0}}});e.showLoading=!0,o.resolved.then(function(){e.showLoading=!1}),o.closed.then(function(){e.refreshData()})},e.refreshData=function(){e.myPromise=n.get(o.config.apiBase+"/sello",{params:e.filter},{"Content-Type":"application/json"}).then(function(o){e.sellos=o.data.sellos,e.filter=o.data.filter,o.data.lotes&&(e.lotes=o.data.lotes),o.data.estatus&&(e.estatus=o.data.estatus)},function(e){console.log(e)})},e.changeLote=function(){e.filter.filter=e.search,e.filter.column=1,e.filter.page=1,e.refreshData()},e.changeEstatus=function(){e.filter.estatus=e.curEstatus,e.refreshData()},e.totalPages=function(){var o=e.filter.totalItems,n=e.filter.pageSize>0?e.filter.pageSize:1;return Math.ceil(o/n)},e.movePage=function(o){"right"===o&&e.filter.page<e.filter.totalItems&&e.filter.page++,"left"===o&&e.filter.page>0&&e.filter.page--,e.refreshData()},e.deletesello=function(t){a.swal({title:"Esta seguro?",text:"Esta seguro de quere elimnar este lote ("+t+")!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Eliminar!",cancelButtonText:"No, cancelar!",closeOnConfirm:!1,closeOnCancel:!0},function(i){i&&n["delete"](o.config.apiBase+"/sello/DeleteLote/?id="+t,{"Content-Type":"application/json"}).then(function(o){e.refreshData(),a.swal("Eliminado!","Lote Eliminado.","success")})})},e.refreshData()}]),angular.module("app").controller("selloEditCtrl",["$scope","$rootScope","$http","selloId",function(e,o,n,t){e.myPromise=!1,e.loadingMsg="Cargando...",e.sello={inicial:"","final":"",espacios:6,lote:""},e.selloId=t,e.getSello=function(){e.myPromise=n.get(o.config.apiBase+"/sello/GetCreate",{"Content-Type":"application/json"}).then(function(o){e.sello=o.data},function(e){console.log(e)})},e.titleMsg=e.selloId>0?"Editando sello":"Agregando sello",e.cancel=function(){e.$close()},e.saveData=function(t){console.log(t),t&&(e.selloId>0?e.myPromise=n.put(o.config.apiBase+"/sello/"+e.selloId,e.sello,{"Content-Type":"application/json"}).then(function(n){o.success("sello","sello guardado"),e.$close()},function(e){}):e.myPromise=n.post(o.config.apiBase+"/sello/",e.sello,{"Content-Type":"application/json"}).then(function(n){o.success("sellos","sello guardado"),e.$close()},function(e){}))},e.getSello()}]),angular.module("app").directive("dynamic",function(e){return{restrict:"A",replace:!0,link:function(o,n,t){o.$watch(t.dynamic,function(t){n[0].innerHTML=t,e(n.contents())(o)})}}}),angular.module("app").directive("inputform",function(){return{restrict:"E",link:function(e,o,n){e.display=n.display,e.collabel=n.collabel?n.collabel:"col-md-2",e.collinput=n.collinput?n.collinput:"col-md-10",e.name=n.name,e.disabled="true"==n.disabled,e.ngRequired=n.ngRequired,e.type=n.type?n.type:"text",e.pat="","email"==n.type&&(e.pat=/^[\w\-\.\+]+\@[a-zA-Z0-9\.\-]+\.[a-zA-z0-9]{2,4}$/)},scope:{ngModel:"=",field:"=field",ngChange:"="},templateUrl:function(e,o){var n="directives/input.form/input.directive.t.h.html";return"v"==o.dir&&(n="directives/input.form/input.directive.t.v.html"),n}}}),angular.module("app").directive("selectform",function(){return{restrict:"E",replace:!0,link:function(e,o,n){e.display=n.display,e.collabel=n.collabel?n.collabel:"col-md-2",e.collinput=n.collinput?n.collinput:"col-md-10",e.name=n.name,e.ngRequired="true"==n.ngRequired,e.disabled="true"==n.disabled,e.pat=""},scope:{ngModel:"=",field:"=field",option:"=option",ngChange:"="},templateUrl:function(e,o){var n="directives/input.form/input.directive.s.h.html";return"v"==o.dir&&(n="directives/input.form/input.directive.s.v.html"),n}}}),angular.module("app").directive("dateform",function(){return{restrict:"E",replace:!0,link:function(e,o,n){e.opened=!1,e.dateOptions={},e.eventSources=[],e.change=function(e){},e.dateSelection=function(e){},e.formats=["MM/dd/yyyy","dd-MMMM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"],e.format=e.formats[0],e.altInputFormats=["M!/d!/yyyy"],e.display=n.display,e.collabel=n.collabel?n.collabel:"col-md-2",e.collinput=n.collinput?n.collinput:"col-md-10",e.name=n.name,e.ngRequired="true"==n.ngRequired,e.type=n.type?n.type:"text",e.pat="",e.disabled="true"==n.disabled,"email"==n.type&&(e.pat=/^[\w\-\.\+]+\@[a-zA-Z0-9\.\-]+\.[a-zA-z0-9]{2,4}$/)},scope:{ngModel:"=ngModel",field:"=field",ngChange:"="},templateUrl:function(e,o){var n="directives/input.form/input.directive.d.h.html";return"v"==o.dir&&(n="directives/input.form/input.directive.d.v.html"),n}}});